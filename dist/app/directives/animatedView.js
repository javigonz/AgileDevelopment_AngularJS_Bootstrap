app.directive("animatedView",["$route","$anchorScroll","$compile","$controller",function($route,$anchorScroll,$compile,$controller){return{restrict:"ECA",terminal:!0,link:function(scope,element,attr){function destroyLastScope(){lastScope&&(lastScope.$destroy(),lastScope=null)}function clearContent(){element.html(""),destroyLastScope()}function update(){locals=$route.current&&$route.current.locals,template=locals&&locals.$template,template?defaults.disabled?bindElement():element.children().length>0?animate(defaults.viewExitAnimation):animateEnterView(defaults.viewEnterAnimation):clearContent()}function animateEnterView(animation){$(element).css("display","block"),bindElement(),animate(animation)}function animate(animationType){switch(animationType){case"fadeOut":$(element.children()).animate({},defaults.duration,function(){animateEnterView("slideLeft")});break;case"slideLeft":$(element.children()).animate({left:"-="+defaults.slideAmount,opacity:1},defaults.duration);break;case"slideRight":$(element.children()).animate({left:"+="+defaults.slideAmount,opacity:1},defaults.duration)}}function bindElement(){element.html(template),destroyLastScope();var controller,link=$compile(element.contents()),current=$route.current;lastScope=current.scope=scope.$new(),current.controller&&(locals.$scope=lastScope,controller=$controller(current.controller,locals),element.children().data("$ngControllerController",controller)),link(lastScope),lastScope.$emit("$viewContentLoaded"),lastScope.$eval(onloadExp),$anchorScroll()}var lastScope,locals,template,onloadExp=attr.onload||"",defaults={duration:500,viewEnterAnimation:"slideLeft",viewExitAnimation:"fadeOut",slideAmount:50,disabled:!1},options=scope.$eval(attr.animations);angular.extend(defaults,options),scope.$on("$routeChangeSuccess",update),update()}}}]);